<!doctype html>
<html>
  <head>
    <meta name="viewport" content="user-scalable=no, width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, minimal-ui">
    <meta name="apple-mobile-web-app-capable" content="yes">

    {#  accepting from app.js res.render
        title :         'whatadrag'
        data_from_database.idtags[]
                          .domtags[]
                          .filenames[]
                          .widths[]
                          .heights[]
                          .posleft[]
                          .postop[]
                          .opacities[]
                          .z_indexs[]
        config            .port
                          .slashimagedirslash
                          .use_cdn
    #}

    <title>{{ title }}</title>

    {# css #}
    {# css rules are overwritten by links that follow #}
    <link rel="stylesheet" type="text/css" href="/css/style.css" />

    {# jquery scripts #}
    {% if config.use_cdn %}
    <script src="//code.jquery.com/jquery-1.12.0.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery.form/3.51/jquery.form.min.js"></script>
    <script src="//code.jquery.com/ui/1.11.4/jquery-ui.min.js"></script>
    {% else %}
    <script src="js/cdn_locals/jquery.js"></script>
    <script src="js/cdn_locals/jquery.form.min.js"></script>
    <script src="js/cdn_locals/jquery-ui.min.js"></script>
    {% endif %}

    {# touch supports (must follow jquery) #}
    {% if config.use_cdn %}
    <script src="//cdnjs.cloudflare.com/ajax/libs/jqueryui-touch-punch/0.2.3/jquery.ui.touch-punch.min.js"></script>
    {% else %}
    <script src="js/cdn_locals/jquery.ui.touch-punch.js"></script>
    {% endif %}

    {# https://github.com/benmajor/jQuery-Touch-Events #}
    <script type="text/javascript" src="js/jquery.mobile-events.min.js"></script>

    {# resize and rotate #}
    {% if config.use_cdn %}
    <script src="//cdn.jsdelivr.net/interact.js/1.2.6/interact.min.js"></script>
    {% else %}
    <script src="js/cdn_locals/interact.min.js"></script>
    {% endif %}

    {# socket io #}
    {% if config.use_cdn %}
    <script src="https://cdn.socket.io/socket.io-1.3.7.js"></script>
    {% else %}
    <script src="js/cdn_locals/socket.io-1.3.7.js"></script>
    {% endif %}

    {# bookmark icon link #}
    <link rel="apple-touch-icon" href="images/apple-touch-icon.png" />

  </head>

  <body>
    <div id='wrapper'>
      <div id="images">
        {# for each filename in data_from_database
           assign the title to the filename
           id will be domtag, but could have been loop.index0
           place the file in the dom using
           top, left, width, height, z-index
           loop.index0 is a variable from nunjucks
         #}

        {% for filename in data_from_database.filenames %}
        <img  title={{filename}}
              id={{data_from_database.domtags[loop.index0]}}
              class = 'resize-drag drawing'
              style='z-index: {{data_from_database.z_indexs[loop.index0]}};
                         top: {{data_from_database.postop[loop.index0]}};
                        left: {{data_from_database.posleft[loop.index0]}};
                       width: {{data_from_database.widths[loop.index0]}};
                      height: {{data_from_database.heights[loop.index0]}};
                   transform: {{data_from_database.matrixes[loop.index0]}};
                     opacity: {{data_from_database.opacities[loop.index0]}};
              -webkit-filter: {{data_from_database.filters[loop.index0]}};'
                  data-scale='{{data_from_database.scales[loop.index0]}}'
                  data-angle='{{data_from_database.angles[loop.index0]}}'
                         src='{{config.slashimagedirslash}}{{filename}}'>
        {% endfor %}

      </div> {# end of images div #}

      <div id='navigation_toggle_button_container'>
        <button id='navigation_toggle_button'>
          <div id='line_one'>
          </div>
          <div id='line_two'>
          </div>
          <div id='line_three'>
          </div>
        </button>
      </div>

      <div id='navigation_container'>
        <div id='dragger_switches_button' class='button navigation_button'> draggers
          <img class='icon_image' src='/images/draggers_icon.png'>
        </div>

        <div id='options_container_button' class='button navigation_button'> options
          <img class='icon_image' src='/images/options.png'>
        </div>

        <form id='upload_image_button' name='title' method='post'
              enctype='multipart/form-data'
              action='addfile/' runat='server'>
          <div class='btn-file button navigation_button'> upload
            <img class='icon_image' src='/images/camera_upload.png'>
            <input id='fileselect' type='file' name='upl'>
          </div>
        </form>

        <div id='exit_door' class='button navigation_button'> remove
          <img class='icon_image' src='/images/exit_door.png'>
        </div>
        <div id='rightbutton' class='button_no_show'></div>
      </div>

      <div id='options_container'>
        <div id='drag_stretch_button' class='button options_button drag-is-open'> -drag- </div>
        <div id='debug_button' class='button options_button'> info is off </div>
        <div id='reset_page_button' class='button options_button'> reset page </div>
        <div id='nothing1' class='button_no_show'>  </div>
        <div id='nothing2' class='button_no_show'>  </div>
      </div>

      <div id='upload_preview_container' class='rainbow_border'>
        <img id='image_upload_preview' src='/images/1x1.png'/>
        <div id='confirm_or_reject_container'>
          <div id='confirm_upload_button' class='confirm_button confirm_yes'> Confirm Upload </div>
          <div id='reject_upload_button' class='confirm_button confirm_no'> Cancel </div>
        </div>
        <div id='confirm_or_reject_container_info'> </div>
      </div>

      <div id='delete_preview_container' class='rainbow_border'>
        <img id='delete_preview' src='/images/1x1.png'/>
        <div id='delete_confirm_or_reject_container'>
          <div id='confirm_delete_button' class='confirm_button confirm_yes'> Confirm Delete </div>
          <div id='reject_delete_button' class='confirm_button confirm_no'> Cancel </div>
        </div>
        <div id='delete_confirm_or_reject_container_info'></div>
      </div>

      <div id='dragger_switches_container'>
        <div id='dragger_all_switch' class='dragger_all_switch'><span> -All- </span></div>
        <div id='stretch_dragger_switch' class='dragger_switch'><span> Stretch </span></div>
        <div id='rotation_dragger_switch' class='dragger_switch'><span> Rotate </span></div>
        <div id='opacity_dragger_switch' class='dragger_switch'><span> Opacity </span></div>
        <div id='blur_brightness_dragger_switch' class='dragger_switch'><span> Blur <br> Brightness </span></div>
        <div id='contrast_saturate_dragger_switch' class='dragger_switch'><span> Contrast <br> Saturation </span></div>
        <div id='grayscale_invert_dragger_switch' class='dragger_switch'><span> Grayscale <br> Inversion </span></div>
        <div id='party_dragger_switch' class='dragger_switch'><span> Party </span></div>
      </div>
{#
      <div id='draggers_container'>
#}
          <div id='stretch_dragger' class='dragger dragger_transitions'> S </div>
          <div id='rotation_dragger' class='dragger dragger_transitions'> R </div>
          <div id='opacity_dragger' class='dragger dragger_transitions'> O </div>
          <div id='blur_brightness_dragger' class='dragger dragger_transitions'> B </div>
          <div id='contrast_saturate_dragger' class='dragger dragger_transitions'> C </div>
          <div id='grayscale_invert_dragger' class='dragger dragger_transitions'> G </div>
          <div id='party_dragger' class='dragger dragger_transitions'> P </div>
{#
      </div>
#}
    </div> {# wrapper #}
    {# main script #}
    <script>
      var image_dir = {{config.slashimagedirslash}};
    </script>
    <script src="js/main.js"></script>
  </body>
</html>
